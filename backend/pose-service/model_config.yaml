# HMR2 Model Configuration
# This file should be placed at ~/.cache/4DHumans/logs/train/multiruns/hmr2/0/model_config.yaml

SMPL:
  MODEL_PATH: data/smpl
  GENDER: neutral
  NUM_BODY_JOINTS: 23
  JOINT_REGRESSOR_EXTRA: data/SMPL_to_J19.pkl
  MEAN_PARAMS: data/smpl_mean_params.npz

EXTRA:
  FOCAL_LENGTH: 5000
  NUM_LOG_IMAGES: 4
  NUM_LOG_SAMPLES_PER_IMAGE: 8
  PELVIS_IND: 39

GENERAL:
  TOTAL_STEPS: 1000000
  LOG_STEPS: 1000
  VAL_STEPS: 1000
  CHECKPOINT_STEPS: 10000
  CHECKPOINT_SAVE_TOP_K: 1
  NUM_WORKERS: 6
  PREFETCH_FACTOR: 2

TRAIN:
  LR: 0.00001
  WEIGHT_DECAY: 0.0001
  BATCH_SIZE: 48
  LOSS_REDUCTION: mean
  NUM_TRAIN_SAMPLES: 2
  NUM_TEST_SAMPLES: 64
  POSE_2D_NOISE_RATIO: 0.01
  SMPL_PARAM_NOISE_RATIO: 0.005

MODEL:
  IMAGE_SIZE: 256
  IMAGE_MEAN: [0.485, 0.456, 0.406]
  IMAGE_STD: [0.229, 0.224, 0.225]
  BACKBONE:
    TYPE: vit
  SMPL_HEAD:
    TYPE: transformer_decoder
    IN_CHANNELS: 2048
    TRANSFORMER_DECODER:
      depth: 6
      heads: 8
      mlp_dim: 1024
      dim_head: 64
      dropout: 0.0
      emb_dropout: 0.0
      norm: layer
      context_dim: 1280

LOSS_WEIGHTS:
  KEYPOINTS_3D: 0.05
  KEYPOINTS_2D: 0.01
  GLOBAL_ORIENT: 0.001
  BODY_POSE: 0.001
  BETAS: 0.0005
  ADVERSARIAL: 0.0005

DATASETS:
  BETAS_REG: True
  CONFIG:
    SCALE_FACTOR: 0.3
    ROT_FACTOR: 30
    TRANS_FACTOR: 0.02
    COLOR_SCALE: 0.2
    ROT_AUG_RATE: 0.6
    TRANS_AUG_RATE: 0.5
    DO_FLIP: True
    FLIP_AUG_RATE: 0.5
    EXTREME_CROP_AUG_RATE: 0.10
    EXTREME_CROP_AUG_LEVEL: 1
